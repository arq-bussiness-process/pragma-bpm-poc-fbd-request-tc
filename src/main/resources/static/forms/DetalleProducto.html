<h1>Solicitud de Tarjeta de Credito en Linea</h1>
<br>
<br>
<p>Indicanos la informacion del producto que estas buscando</p>
<br>


<form role="form" name="variablesForm">
	<div class="row">
		<div class="col-xs-6">
			<h2>Detalle producto solicitado</h2>

			<!-- Gender -->
			<div class="form-group">
				<label for="produtType">Tipo Producto Solicitado</label>
				<div class="controls">
					<!--select box -->
					<select id="produtType" class="form-control" cam-variable-name="produtType"
						cam-variable-type="String" ng-change="calculateLoan()">
						<option value="Credito" checked>Credito</option>
						<option value="Tarjeta">Tarjeta</option>
					</select>

				</div>
			</div>
			
			<!-- Loan Amount -->
			<div class="form-group">
				<label for="inputLoanAmount">Cantidad</label>
				<div class="controls">
					<input id="inputLoanAmount" required class="form-control" cam-variable-type="Double"
						cam-variable-name="loanAmount" min="1000" ng-change="calculateLoan()" name="loanAmount"
						type="number" />
				</div>
			</div>
			
			<!-- Runtime in Years -->
			<div class="form-group">
				<label for="inputLoanRuntime">Duracion del credito (Años)</label>
				<div class="controls">
					<input id="inputLoanRuntime" required class="form-control" cam-variable-type="Double"
						cam-variable-name="loanRuntime" min="2" max="30" ng-change="calculateLoan()" name="loanRuntime"
						type="number" />
				</div>
			</div>

			<!-- Loan Type -->
			<div class="form-group">
				<label for="selectLoanType">Tipo de Credito</label>
				<div class="controls">
					<!--select box -->
					<select id="selectLoanType" required class="form-control" name="loanType"
						cam-variable-name="loanType" cam-variable-type="String" ng-change="calculateLoan()">
						<option value="mortage" checked>Mortage Loan (5%)</option>
						<option value="cashAdvance">Cash Advance (10%)</option>
					</select>
				</div>

				<!-- Custom validation message for select box -->
				<p ng-if="variablesForm.loanType.$invalid" style="color: red">
					Please select a loan type.
				</p>
			</div>
			
			<!-- Consulta centrales de riesgo -->
			<div class="form-group">
				<label for="consultaCentrales">Autoriza consulta centrales de riesgo</label>
				<div class="controls">
					<!--select box -->
					<select id="consultaCentrales" class="form-control" cam-variable-name="consultaCentrales"
						cam-variable-type="String" ng-change="calculateLoan()">
						<option value="SI" checked>SI</option>
						<option value="NO">NO</option>
					</select>
				</div>
			</div>

			

			

			<!-- calculate monthly payment -->
			Projected monthly payment:
			<p ng-if="monthlyPayment" class="alert alert-success">
				{{monthlyPayment}}€ at {{interest}}% interest rate.
			</p>

			<p ng-if="!monthlyPayment" class="alert alert-danger">
				Invalid selection.
			</p>

			<!-- The following code demonstrates use of custom scripting.
            The 'cam-script' directive makes sure the the script is loaded and can bind to the angular $scope for the form.
            Access to form fields is provided through $scope.variablesForm.
         -->
			<script cam-script type="text/form-script">
      $scope.calculateLoan = function() {
        var form = $scope.variablesForm;

        if(!form.loanType.$valid || !form.loanAmount.$valid || !form.loanRuntime.$valid) {
          $scope.monthlyPayment = undefined;

        } else {

          var loanAmount = form.loanAmount.$modelValue;
          var years = form.loanRuntime.$modelValue;
          var loanType = form.loanType.$modelValue;
          var interestRate = 0;

          if(loanType == "mortage") {
            interestRate = 0.05;
          } else if(loanType == "cashAdvance") {
            interestRate = 0.10;
          }

          $scope.interest = 100 * interestRate;

          // calculate monthly payment using special formula provided by Bobby G
          $scope.monthlyPayment = Math.round((loanAmount * ((Math.pow((1+interestRate),years)*interestRate) / (Math.pow((1+interestRate),years)-1))) * (1/12));

        }
      }

      </script>

		</div>


	</div>
	</div>
</form>